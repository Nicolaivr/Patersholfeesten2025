<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Patersholfeesten 2025 - Festival Tijdlijn</title>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@fullcalendar/resource-timeline@6.1.11/index.global.min.css" rel="stylesheet">
  <style>
    body { font-family: 'Montserrat', Arial, sans-serif; background: #f5f7fb; margin: 0; padding: 0; }
    #calendar { max-width: 1200px; margin: 2rem auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.04);}
    header { background: #2e3d51; color: #fff; padding: 2rem 1rem 1rem 1rem; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.04);}
    header h1 { margin: 0; font-size: 2.5rem; font-weight: 700; letter-spacing: 2px; }
    header p { margin: 0.5rem 0 0 0; font-size: 1.15rem; font-weight: 400; }
  </style>
</head>
<body>
  <header>
    <h1>Patersholfeesten 2025</h1>
    <p>Festival Tijdlijn &mdash; Overzicht per dag en per podium</p>
  </header>
  <div id="calendar"></div>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/resource-timeline@6.1.11/index.global.min.js"></script>
  <script>
    // Define your possible stages as resources
    const stages = [
      { id: 'kaatsspelplein', title: 'Kaatsspelplein' },
      { id: 'viersprong', title: 'Viersprong' },
      { id: 'algemeen', title: 'Algemeen' }
    ];

    fetch('events.json')
      .then(resp => resp.json())
      .then(data => {
        // Map your events to FullCalendar format
        const events = data.map(ev => ({
          id: ev.title + ev.start + ev.stage,
          resourceId: ev.stage,
          title: ev.title + (ev.extra_info ? ' â€” ' + ev.extra_info : ''),
          start: ev.date + 'T' + (ev.start.length === 4 ? '0' + ev.start : ev.start),
          end: ev.date + 'T' + (ev.end.length === 4 ? '0' + ev.end : ev.end)
        }));

        // Calculate the earliest and latest event for slotMinTime/slotMaxTime
        const mins = data.map(ev => Number((ev.start.length === 4 ? '0'+ev.start : ev.start).split(':')[0]));
        const maxs = data.map(ev => Number((ev.end.length === 4 ? '0'+ev.end : ev.end).split(':')[0]));
        const minHour = Math.min(...mins, 8);
        const maxHour = Math.max(...maxs, 24);

        const calendar = new FullCalendar.Calendar(document.getElementById('calendar'), {
          schedulerLicenseKey: 'CC-Attribution-NonCommercial-NoDerivatives',
          initialView: 'resourceTimelineDay',
          locale: 'nl',
          height: 'auto',
          slotMinTime: String(minHour).padStart(2, '0') + ':00:00',
          slotMaxTime: String(maxHour+2).padStart(2, '0') + ':00:00',
          resourceAreaHeaderContent: 'Podium',
          resources: stages,
          events: events,
          nowIndicator: true,
          headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'resourceTimelineDay,resourceTimelineWeek'
          },
          views: {
            resourceTimelineDay: { buttonText: 'Dag' },
            resourceTimelineWeek: { buttonText: 'Week' }
          },
          eventDidMount: function(info) {
            // Optional: color coding per stage
            if(info.event.extendedProps.resourceId === 'kaatsspelplein') {
              info.el.style.background = '#eafaf5';
              info.el.style.borderColor = '#1abc9c';
            } else if(info.event.extendedProps.resourceId === 'viersprong') {
              info.el.style.background = '#fcf3eb';
              info.el.style.borderColor = '#e67e22';
            } else if(info.event.extendedProps.resourceId === 'algemeen') {
              info.el.style.background = '#f2f5fa';
              info.el.style.borderColor = '#2e3d51';
            }
          },
          eventTimeFormat: { hour: '2-digit', minute: '2-digit', hour12: false }
        });
        calendar.render();
      });
  </script>
</body>
</html>
